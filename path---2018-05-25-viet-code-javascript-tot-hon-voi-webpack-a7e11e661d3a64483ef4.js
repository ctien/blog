webpackJsonp([29],{"./node_modules/json-loader/index.js!./.cache/json/2018-05-25-viet-code-javascript-tot-hon-voi-webpack.json":function(n,s){n.exports={data:{markdownRemark:{html:'<h1>Trong Series này</h1>\n<ol>\n<li><a href="2018-05-25-viet-code-javascript-tot-hon-voi-webpack">Webpack là gì và tại sao ta phải xài nó</a></li>\n<li><a href="2018-05-27-huong-dan-webpack-4-cho-nguoi-moi-bat-dau">Dùng Loaders, code slitting trong webpack</a></li>\n<li><a href="2018-05-28-huong-dan-webpack-4-cho-nguoi-moi-bat-dau-phan-3">Plugins, Development Server</a></li>\n</ol>\n<h2>Vấn đề</h2>\n<p>Viết code client-side nếu không có các công cụ hỗ trợ thì trước sau vì cũng giống như đống hỗn độn trên desktop, để maintain và người khác có thể vào đọc hiểu được thì việc code được tổ chức tốt là điều ai cũng biết, lý thuyết là thế, nhưng nếu cứ làm việc theo kiểu cũ cứ quăng script tràng lan bằng thẻ <code>&#x3C;script></code> sẽ chẳng dễ gì sắp xếp và nhớ nổi cái nào là cái nào nếu, add thêm cỡ chục files, <em>best practice</em> khuyên rằng hạn chế số lượng file script càng ít càng tốt, tốt nhất là 1 file duy nhất.</p>\n<p>Trước đây có nhiều giải pháp cho vấn đề như là Gulp, dùng để bunch toàn bộ javascript thành 1 file. Nhưng chưa đủ. Với Gulp chúng ta đã đẩy các dependency ngang hàng nhau, và phụ thuộc vào biến global để chia sẽ dữ liệu giữa các files.</p>\n<h3>Cách tốt hơn</h3>\n<p>Nếu trước đây chưa từng sử dụng mấy cái tool để quản lý asset ở frontend, tốt nhất là học luôn Webpack, bỏ qua Gulp, Gruntjs luôn. Còn nếu nếu đã từng dùng mấy task runner kiểu Gulp, Gruntjs, thì chuyển qua dùng webpack cũng không khó khăn lắm, chỉ là khác nhau cách tổ chức và quản lý dependency.</p>\n<h2>Webpack vs. Gulp</h2>\n<p>Chắc đã từng nghe tới câu này: <strong>Gulp là task runner, Webpack là module bundler</strong>, ý nhĩa thật sự sau câu này là gì?</p>\n<p>Gulp là công cụ tự động hóa tốt, cho phép chúng ta setup một mớ các tiến trình phức tạp cần thực hiện (một cách tự động) bằng javascript, rồi chạy nó bằng một lệnh duy nhất. Vấn đề với Gulp là nếu code file A depend vào code ở file B, bạn cần báo cáo với Gulp để nó include file A trước, và khi bạn thêm càng lúc càng nhiều file depend chồng chéo kiểu này, cây dependency là lớn dần, và sẽ gần như không thể maintain được nữa, vì chúng ta phải config bằng tay, nếu sử dụng file manifest với plugin <code>asset-builder</code> cũng không thể cứu vãn.</p>\n<p><img src="https://res.cloudinary.com/forestry-demo/image/fetch/c_limit,dpr_auto,f_auto,q_80,w_674/https://forestry.io/uploads/2018/03/webpack_fighter_of_the_gulpstack_champion_of_the_bundle.png"></p>\n<p>Bài toán dependency này đã được Webpack giải quyết triệt để. Những gì bạn cần làm là báo với Webpack file <strong>entry</strong> point mình cần bundle là gì, chuyện bạn <em>import module</em> lúc code sẽ do webpack đảm nhiệm chuyện dựng lên dependency graph, webpack sẽ bundle cho bạn 1 file duy nhất bạn cần. Chúng ta khỏi phải báo cáo với webpack thứ tự các file nào cần trước hay sau, để đó Webpack lo!</p>\n<p>Ngắn gọn là: với Gulp dependency bị giới hạn vì nó yêu cầu mình tự chỉ định sự phụ thuộc, Webpack thì nó dùng logic để tính toán rồi bundle đúng thứ tự.</p>\n<h2>Viết code Module</h2>\n<p>Để Webpack hoạt động như phép màu như vậy, chúng ta chỉ cần viết javascript của mình dạng <em>module</em>. Viết module trong javascript là tách các file ra thành nhiều file, việc sử dụng code giữa các file sẽ thực hiện bằng <strong>export</strong> và <strong>import</strong></p>\n<p>Webpack hổ trợ 2 chuẩn module hóa hiện giờ là <strong>EcmaScript</strong> và  <strong>CommonJS</strong>. Ví dụ bên dưới để hình dung cách viết module trong file <code>hello.js</code> rồi <strong>import</strong> vào trong file <code>app.js</code> bằng cả 2 kiểu viết EcmaScript và CommonJS</p>\n<p>Viết kiểu <strong>EcmaScript</strong></p>\n<p><strong>hello.js</strong></p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Hello Binh An!\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p><strong>app.js</strong></p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>hello<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'./hello\'</span>\n<span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>Viết kiểu <strong>CommonJS</strong></p>\n<p><strong>hello.js</strong></p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Hello Bình An!\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p><strong>app.js</strong></p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code><span class="token keyword">const</span> hello <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'./hello\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<h2>Cấu hình Webpack</h2>\n<p>Một điểm hay của webpack là nếu có ai đó đã config rồi thì những người sau không cần phải vào file config để hiểu cách tổ chức code, chỉ cần hiểu được cách tổ chức code của project.</p>\n<p>Giờ thử config đơn giản nhất để hiểu một số thành phần quan trọng nhất của webpack</p>\n<p>Tổ chức project như vầy</p>\n<div class="gatsby-highlight">\n      <pre class="language-basic"><code>src<span class="token operator">/</span>\n    app.js\nwebpack.config.js\n</code></pre>\n      </div>\n<p>Mặt định Webpack sẽ tìm file config với tên là <strong>webpack.config.js</strong>. Tiếp chúng ta cần cài <strong>webpack</strong> và <strong>webpack-cli</strong></p>\n<div class="gatsby-highlight">\n      <pre class="language-bash"><code><span class="token function">npm</span> init -y\n<span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack webpack-cli\n</code></pre>\n      </div>\n<p>Trong file <strong>webpack.config.js</strong></p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code><span class="token keyword">var</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'path\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n    entry<span class="token punctuation">:</span> <span class="token string">\'./src/app.js\'</span><span class="token punctuation">,</span>\n    output<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">\'dist\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        filename<span class="token punctuation">:</span> <span class="token string">\'bundle.js\'</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>2 phần quan trọng nhất mà phải biết là <strong>entry</strong> - file source nằm ở đâu và <strong>output</strong> - file sẽ bundle ở đâu. Sử dụng module <code>path</code> để biết vị trí thực tế lúc chạy.</p>\n<p>Chạy CLI để bundle</p>\n<div class="gatsby-highlight">\n      <pre class="language-bash"><code>./node_modules/webpack-cli/bin/webpack.js\n</code></pre>\n      </div>\n<p>Nó sẽ đọc source trong file <code>src/app.js</code> rồi compile vào <code>dist/bundle.js</code>. Thư mục sau khi chạy xong sẽ có</p>\n<div class="gatsby-highlight">\n      <pre class="language-basic"><code>dist<span class="token operator">/</span>\n    bundle.js\nsrc<span class="token operator">/</span>\n    app.js\npackage.json\nwebpack.config.js\n</code></pre>\n      </div>\n<p>Để rút chạy đoạn CLI dài ngoằn <code>./node_modules/webpack-cli/bin/webpack.js</code> có thể thêm một custom script trong file <strong>package.json</strong>. Bạn có thể chạy nó bằng <code>npm run SCRIPT_NAME</code></p>\n<p>Thêm vào trong <strong>package.json</strong></p>\n<div class="gatsby-highlight">\n      <pre class="language-json"><code><span class="token punctuation">{</span>    \n    <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token property">"test"</span><span class="token operator">:</span> <span class="token string">"echo \\"Error: no test specified\\" &amp;&amp; exit 1"</span><span class="token punctuation">,</span>\n        <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"./node_modules/webpack-cli/bin/webpack.js"</span><span class="token punctuation">,</span>\n        <span class="token property">"watch"</span><span class="token operator">:</span> <span class="token string">"./node_modules/webpack-cli/bin/webpack.js --watch"</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>Giờ chúng ta có thể chạy bằng lệnh <code>npm run build</code>, ở trên chúng ta cũng vừa thêm đoạn <code>npm run watch</code>, thêm option <code>--watch</code> để khi có bất kỳ thay đổi nào nó sẽ tự động detect và compile lại.</p>\n<p>!!!! CUNG HỶ !!!!!</p>\n<p>Bạn đã chạm được vào cánh cửa đầu tiên của webpack, webpack còn nhiều khả năng nữa, tuy nhiên module bundle là core feature, bài tiếp theo chúng ta sẽ khám phá nhiều hơn như loaders, plugins, development server.</p>\n<p><a href="2017-10-18-import-va-export-trong-javascript">Tìm hiểu thêm về import và export</a></p>\n<p><a href="https://forestry.io/blog/write-better-javascript-with-webpack/">Link bài gốc</a></p>\n<p>Tác giả: DJ Walker</p>',frontmatter:{date:"May 25, 2018",path:"/2018-05-25-viet-code-javascript-tot-hon-voi-webpack",tags:["javascript","webpack"],title:"Webpack là gì và tại sao ta phải xài nó",desc:"Bài này sẽ nói rõ tại sao Webpack là sự lựa chọn sáng suốt cho bundle javascript"}}},pathContext:{prev:{excerpt:"Trong Series này Webpack là gì và tại sao ta phải xài nó Dùng Loaders, code slitting trong webpack Plugins, Development Server Chúng ta mở lại file  package.json , sửa lại chút Với cách setup này, chỉ cần chạy   chúng ta sẽ chạy webpack ở development...",html:'<h1>Trong Series này</h1>\n<ol>\n<li><a href="2018-05-25-viet-code-javascript-tot-hon-voi-webpack">Webpack là gì và tại sao ta phải xài nó</a></li>\n<li><a href="2018-05-27-huong-dan-webpack-4-cho-nguoi-moi-bat-dau">Dùng Loaders, code slitting trong webpack</a></li>\n<li><a href="2018-05-28-huong-dan-webpack-4-cho-nguoi-moi-bat-dau-phan-3">Plugins, Development Server</a></li>\n</ol>\n<p>Chúng ta mở lại file <strong>package.json</strong>, sửa lại chút</p>\n<div class="gatsby-highlight">\n      <pre class="language-diff"><code>{\n    ...\n    "scripts": {\n<span class="token inserted">+     "develop": "webpack --mode development --watch",</span>\n<span class="token inserted">+     "build": "webpack --mode production"</span>\n    },\n    ...\n}\n</code></pre>\n      </div>\n<p>Với cách setup này, chỉ cần chạy <code>npm run develop</code> chúng ta sẽ chạy webpack ở development mode và bật tính năng detect thay đổi để chạy lại.</p>\n<p>Khi chạy <code>npm run build</code> chúng ta sẽ chạy webpack ở mode production, khi chạy ở mode này code sẽ được minified lại bằng Uglify JS, size nhỏ hơn khi chạy dev mode.</p>\n<h2>Loaders</h2>\n<p>Loaders là gì? loaders là những thư viện sẽ can thiệp trước lúc chúng ta import file, nó cho phép webpack mở rộng khả năng không chỉ còn là bundle javascript thôi, mà cả những static resource khác, như css, image, svg, ...</p>\n<h3>Babel Loader</h3>\n<p>Thời điểm hiện tại chắc ai cũng viết JS kiểu mới, để transpile cái ES6 mà ta viết, chúng ta sẽ cần <code>babel-loader</code></p>\n<div class="gatsby-highlight">\n      <pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> --save-dev babel-loader  @babel/core @babel/preset-env\n</code></pre>\n      </div>\n<p>Mở lại file <strong>webpack.config.js</strong></p>\n<div class="gatsby-highlight">\n      <pre class="language-diff"><code>const path = require(\'path\')\n\n  module.exports = {\n    entry: \'./src/index.js\',\n    output: {\n      filename: \'bundle.js\',\n      path: path.resolve(__dirname, \'dist\')\n    },\n<span class="token inserted">+   module: {</span>\n<span class="token inserted">+     rules: [</span>\n<span class="token inserted">+       {</span>\n<span class="token inserted">+         test: /\\.js$/,</span>\n<span class="token inserted">+         exclude: /(node_modules|bower_components)/,</span>\n<span class="token inserted">+         use: {</span>\n<span class="token inserted">+           loader: \'babel-loader\',</span>\n<span class="token inserted">+         }</span>\n<span class="token inserted">+       }</span>\n<span class="token inserted">+     ]</span>\n<span class="token inserted">+   }</span>\n  }\n</code></pre>\n      </div>\n<p>Để cấu hình cách transpile của babel, chúng ta add thêm file <code>.babelrc</code> vào cùng thư mục với <strong>webpack.config.js</strong></p>\n<div class="gatsby-highlight">\n      <pre class="language-json"><code><span class="token punctuation">{</span>\n  <span class="token property">"presets"</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token punctuation">[</span><span class="token string">"@babel/env"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n      <span class="token property">"modules"</span><span class="token operator">:</span> <span class="token boolean">false</span>\n    <span class="token punctuation">}</span><span class="token punctuation">]</span>\n  <span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token property">"plugins"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"syntax-dynamic-import"</span><span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>Đoạn trên chúng ta đang cấu hình để khi Babel transpile, nó không đổi câu <code>import</code> và <code>export</code> về ES5 và cho phép import linh động, sau này dùng đến trong phần slitting code</p>\n<p>Giờ thì cứ vô tư viết ES6 nhé, vì khi bundle, webpack sẽ transpile code của chúng về thành ES5</p>\n<h2>SASS Loader</h2>\n<p>Trước tiên cài một số package để làm việc với SASS</p>\n<div class="gatsby-highlight">\n      <pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> --save-dev style-loader css-loader sass-loader node-sass\n</code></pre>\n      </div>\n<p><strong>webpack.config.js</strong></p>\n<div class="gatsby-highlight">\n      <pre class="language-diff"><code> module.exports = {\n    ...\n    module: {\n      rules: [\n        ...\n<span class="token inserted">+       {</span>\n<span class="token inserted">+         test: /\\.scss$/,</span>\n<span class="token inserted">+         use: [{</span>\n<span class="token inserted">+           loader: \'style-loader\'</span>\n<span class="token inserted">+         }, {</span>\n<span class="token inserted">+           loader: \'css-loader\'</span>\n<span class="token inserted">+         }, {</span>\n<span class="token inserted">+           loader: \'sass-loader\'</span>\n<span class="token inserted">+         }]</span>\n<span class="token inserted">+       }</span>\n      ]\n    }\n  }\n</code></pre>\n      </div>\n<p>Mấy cái loader này sẽ được thực hiện theo thứ tự</p>\n<ul>\n<li><code>sass-loader</code> transforms Sass thành CSS.</li>\n<li><code>css-loader</code> parses CSS vào JavaScript và resolve dependencies.</li>\n<li><code>style-loader</code> chèn CSS vào bên trong thẻ <code>&#x3C;style></code></li>\n</ul>\n<p>Có thể hình dung nó như một function với callback là một function khác</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code><span class="token function">styleLoader</span><span class="token punctuation">(</span><span class="token function">cssLoader</span><span class="token punctuation">(</span><span class="token function">sassLoader</span><span class="token punctuation">(</span><span class="token string">"source"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n</code></pre>\n      </div>\n<p>Sau khi cấu hình như vậy chúng ta có thể import file  <code>.scss</code> bên trong file javascript</p>\n<div class="gatsby-highlight">\n      <pre class="language-diff"><code>import { groupBy } from \'lodash-es\'\nimport people from \'./people\'\n\n<span class="token inserted">+ import \'./style.scss\'</span>\n\n  ...\n</code></pre>\n      </div>\n<p>Tại sao chúng ta lại đi import CSS vào trong file js? Nếu bạn thời kỳ trước việc chèn hầm bà lằng kiểu này là cực kỳ bị lên án, nhưng bây giờ thời thế khác, một số lý do để trọn CSS vào trong js trong development</p>\n<ul>\n<li>Một component javascript sẽ có thể phụ thuộc vào CSS, images, SVG. Nếu được đóng gói thành 1 cục, chúng ta dễ mang nó sử dụng ở nơi khác hơn</li>\n<li>Nếu chúng ta không sử dụng component, đoạn css import trong component cũng sẽ không được import luôn, tránh những việc load css ở tất cả</li>\n<li>Trước đây nếu dùng OOP trong CSS, việc chỉnh sửa một đoạn css sẽ dễ bị side effect, ảnh hướng đến những chổ ta không mong muốn. CSS module để CSS chỉ hoạt động local thôi</li>\n<li>Giảm số lượng HTTP request xuống</li>\n</ul>\n<h3>Image</h3>\n<p>Dùng <code>file-loader</code> để đọc file image. Với HTML chuẩn, image được sử dụng bằng 2 cách là dùng tag <code>img</code> hoặc thuộc tính <code>background-image</code>. Với Webpack, chúng ta có thể optimize cho trường hợp dung lượng image với kích thước nhỏ thành dạng <code>string</code> bên trong javascript luôn. Lúc này trình duyệt không cần load riêng file image nữa</p>\n<p>Cài cái loader</p>\n<div class="gatsby-highlight">\n      <pre class="language-bash"><code>nmp <span class="token function">install</span> --save-dev file-loader\n</code></pre>\n      </div>\n<p>webpack.config.js</p>\n<div class="gatsby-highlight">\n      <pre class="language-diff"><code> module.exports = {\n    ...\n    module: {\n      rules: [\n        ...\n<span class="token inserted">+       {</span>\n<span class="token inserted">+         test: /\\.(png|svg|jpg|gif)$/,</span>\n<span class="token inserted">+         use: [</span>\n<span class="token inserted">+           {</span>\n<span class="token inserted">+             loader: \'file-loader\'</span>\n<span class="token inserted">+           }</span>\n<span class="token inserted">+         ]</span>\n<span class="token inserted">+       }</span>\n      ]\n    }\n  }\n</code></pre>\n      </div>\n<p>Trong lúc code chúng ta vẫn viết bình thường</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code><span class="token keyword">import</span> codeURL <span class="token keyword">from</span> <span class="token string">\'./code.png\'</span><span class="token punctuation">;</span>\n\n<span class="token operator">...</span>\n<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span><span class="token punctuation">(</span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token script language-javascript"><span class="token punctuation">=</span><span class="token punctuation">{</span>codeURL<span class="token punctuation">}</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n  <span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n<span class="token operator">...</span>\n</code></pre>\n      </div>\n<p>Kết quả bundle</p>\n<div class="gatsby-highlight">\n      <pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>data:image/png;base64,iVBO...<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n</code></pre>\n      </div>\n<p>Có thể đọc thêm trên docs của <code>file-loader</code> để xem cách chỉnh kích thước nào thì chuyển nội dung ảnh thành data URI. File loader còn thể thể xử lý trên một số dạng file khác nữa, chứ không chỉ là hình thôi không.</p>\n<h2>Code splitting</h2>\n<p>Trích từ trang chủ webpack</p>\n<blockquote>\n<p>Code splitting là một trong những tính năng hấp dẫn nhất của Webpack. Tính năng này cho phép bạn tách code ra thành nhiều file bundle để load khi cần thiết hoặc load xong xong. Cái này có thể dùng để giảm kích thước file bundle và kiểm soát được load resource hợp lý hơn, nếu sử dụng đúng cách, sẽ giảm đảng kể thời gian load trang</p>\n</blockquote>\n<p>Trước giờ chúng ta chỉ setup để bundle ra 1 file duy nhất từ <code>src/index.js</code> ra file <code>dist/bundle.js</code>. Khi ứng dúng phình ra, chúng ta cần tách code ra thành nhiều file, toàn bộ code đầu cần phải load hết ngay từ đầu đâu nhỉ? Dùng <a href="https://webpack.js.org/guides/code-splitting/">Code Slitting</a> và <a href="https://webpack.js.org/guides/lazy-loading/">Lazy Loading</a> để chỉ load khi cần.</p>\n<div class="gatsby-highlight">\n      <pre class="language-diff"><code>   const path = require(\'path\')\n\n  module.exports = {\n<span class="token deleted">-   entry: \'./src/index.js\',</span>\n<span class="token inserted">+   entry: {</span>\n<span class="token inserted">+     app: \'./src/app.js\'</span>\n<span class="token inserted">+   },</span>\n    output: {\n<span class="token deleted">-     filename: \'bundle.js\',</span>\n<span class="token inserted">+     filename: \'[name].bundle.js\',</span>\n      path: path.resolve(__dirname, \'dist\')\n    },\n    ...\n  }\n</code></pre>\n      </div>\n<p>Với setup như thế này, nếu chúng ta có 2 file trong thư mục <code>src</code> là <code>app.js</code> và <code>chat.js</code>, webpack sẽ bundle ra 2 file <code>chat.bundle.js</code>, <code>app.bundle.js</code></p>\n<p>Bài sau nói tiếp plugins nhé, kết thúc với loaders ở đây</p>\n<p><a href="https://www.sitepoint.com/beginners-guide-webpack-module-bundling/">Link bài gốc</a>\nTác giả: Mark Brown</p>\n<p>Chỉnh sửa theo sự hiểu của mình một tí</p>',id:"E:/anluu/luckyluu/posts/2018-05-27-huong-dan-webpack-4-cho-nguoi-moi-bat-dau/index.md absPath of file >>> MarkdownRemark",timeToRead:5,frontmatter:{date:"2018-05-27T13:35:13.234Z",path:"/2018-05-27-huong-dan-webpack-4-cho-nguoi-moi-bat-dau",tags:["javascript","webpack"],title:"Hướng dẫn webpack 4 cho người mới bắt đầu - Phần 2"}},next:{excerpt:"controlled component vs. uncontrolled component Không giống các element DOM, element FORM sẽ làm việc hơi khác trong React. Data của form sẽ được xử lý bởi component, không phải bởi DOM, thông thường chúng ta sử dụng controlled component, data của...",html:'<p><img src=""></p>\n<h2>controlled component vs. uncontrolled component</h2>\n<p>Không giống các element DOM, element FORM sẽ làm việc hơi khác trong React. Data của form sẽ được xử lý bởi component, không phải bởi DOM, thông thường chúng ta sử dụng controlled component, data của form sẽ được đưa vô component <code>state</code> như hình bên dưới</p>\n<p><img src="https://process.filestackapi.com/cache=expiry:max/Qb7pi8kTzenybAUcijaB"></p>\n<p>Data từ <code>dump components</code> sẽ được gởi vô hàm callback, nơi chúng ta lưu lại các thay đổi</p>\n<p>Nếu sử dụng uncontrolled component, tương tự như HTML form truyền thống, dữ liệu sẽ nằm trong DOM, không nằm trong component state, các component <code>&#x3C;input /></code> hay <code>&#x3C;textarea/></code> sẽ tự quản lý state của nó và tự động thay đổi khi user nhập dữ liệu, nếu cần dữ liệu này, chúng ta query tới DOM đó để lấy giá trị bằng <code>ref</code></p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code><span class="token keyword">class</span> <span class="token class-name">UncontrolledComponentForm</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>\n  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>handleSubmit <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleSubmit<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token function">handleSubmit</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">\'The value is: \'</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>input<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">onSubmit</span><span class="token script language-javascript"><span class="token punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleSubmit<span class="token punctuation">}</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">></span></span>\n          Name<span class="token punctuation">:</span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>input <span class="token operator">=</span> input <span class="token punctuation">}</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Submit<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>Đa số các trường hợp mình thường sử dụng controlled component để làm form, nhìn vào trực quan hơn và mình có thể validate được dữ liệu lúc nhập vào luôn.</p>\n<h2>Dựng Form</h2>\n<p>Sẽ có khá nhiều thư viện có sẵn để làm việc với form, nhưng với cá nhân mình, mình vẫn thích tự build hơn vì nếu mình muốn thêm validate đặc biệt hay tùy biến behavior của nó cũng đơn giản hơn, đồng thời giúp chúng ta nắm rõ hơn về React Form luôn.</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span>Component<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'react\'</span><span class="token punctuation">;</span>  \n\n<span class="token comment" spellcheck="true">/* Import Components */</span>\n<span class="token keyword">import</span> CheckBox <span class="token keyword">from</span> <span class="token string">\'../components/CheckBox\'</span><span class="token punctuation">;</span>  \n<span class="token keyword">import</span> Input <span class="token keyword">from</span> <span class="token string">\'../components/Input\'</span><span class="token punctuation">;</span>  \n<span class="token keyword">import</span> TextArea <span class="token keyword">from</span> <span class="token string">\'../components/TextArea\'</span><span class="token punctuation">;</span>  \n<span class="token keyword">import</span> Select <span class="token keyword">from</span> <span class="token string">\'../components/Select\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> Button <span class="token keyword">from</span> <span class="token string">\'../components/Button\'</span>\n\n<span class="token keyword">class</span> <span class="token class-name">FormContainer</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>  \n  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>\n      newUser<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        name<span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">,</span>\n        email<span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">,</span>\n        age<span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">,</span>\n        gender<span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">,</span>\n        expertise<span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">,</span>\n        about<span class="token punctuation">:</span> <span class="token string">\'\'</span>\n\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n\n      genderOptions<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'Male\'</span><span class="token punctuation">,</span> <span class="token string">\'Female\'</span><span class="token punctuation">,</span> <span class="token string">\'Others\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n      skillOptions<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'Programming\'</span><span class="token punctuation">,</span> <span class="token string">\'Development\'</span><span class="token punctuation">,</span> <span class="token string">\'Design\'</span><span class="token punctuation">,</span> <span class="token string">\'Testing\'</span><span class="token punctuation">]</span>\n\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token comment" spellcheck="true">/* This life cycle hook gets executed when the component mounts */</span>\n\n  handleFormSubmit <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token comment" spellcheck="true">// Form submission logic</span>\n  <span class="token punctuation">}</span>\n  handleClearForm <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token comment" spellcheck="true">// Logic for resetting the form</span>\n  <span class="token punctuation">}</span>\n  changeValue <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token comment" spellcheck="true">//update state</span>\n  <span class="token punctuation">}</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span> <span class="token attr-name">onSubmit</span><span class="token script language-javascript"><span class="token punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleFormSubmit<span class="token punctuation">}</span></span><span class="token punctuation">></span></span>\n\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Input</span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>changeValue<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">/* Name of the user */</span><span class="token punctuation">}</span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Input</span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>changeValue<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">/* Input for Age */</span><span class="token punctuation">}</span> \n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Select</span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>changeValue<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">/* Gender Selection */</span><span class="token punctuation">}</span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>CheckBox</span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>changeValue<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">/* List of Skills (eg. Programmer, developer) */</span><span class="token punctuation">}</span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextArea</span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>changeValue<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">/* About you */</span><span class="token punctuation">}</span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleFormSubmit<span class="token punctuation">}</span></span><span class="token punctuation">></span></span>\n            Submit\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Button</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClearForm<span class="token punctuation">}</span></span><span class="token punctuation">></span></span>\n            Reset\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Button</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">export</span> <span class="token keyword">default</span> FormContainer<span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>Mình sẽ không đi sâu vào các component <code>Input</code>, <code>Select</code>, <code>Checkbox</code>, <code>TextArea</code>, các bạn có thể sử dụng một UI library React bất kỳ, hoặc tự build nếu thích, đa phần các library này sẽ cho phép sử dụng cả 2 kiểu controlled/uncontrolled</p>\n<p>Hàm <code>handleClearForm</code> sẽ reset toàn bộ state</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code>handleClearForm <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>\n  e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> \n    newUser<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n      name<span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">,</span>\n      age<span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">,</span>\n      gender<span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">,</span>\n      skills<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n      about<span class="token punctuation">:</span> <span class="token string">\'\'</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>Bên trong hàm <code>handleFormSubmit</code> ta có thể lấy giá trị của form và thực hiện một xử lý như <code>dispatch</code> ra một action</p>\n<div class="gatsby-highlight">\n      <pre class="language-jsx"><code>handleFormSubmit <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> userData <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>newUser<span class="token punctuation">;</span>\n\n    <span class="token comment" spellcheck="true">// nếu connect FormContainer vào Redux, ta có thể dùng dispatch ở đây</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">someFunction</span><span class="token punctuation">(</span>userData<span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>   \n</code></pre>\n      </div>\n<p>Bài này tác giả chưa đề cập những vấn đề sâu hơn như validate, bài sau mình sẽ bổ sung thêm.</p>\n<p><a href="https://www.codementor.io/blizzerand/building-forms-using-react-everything-you-need-to-know-iz3eyoq4y">Link bài gốc</a></p>\n<p>Tác giả: Manjunath</p>',
id:"E:/anluu/luckyluu/posts/2018-05-22-lam-viec-voi-form-trong-react/index.md absPath of file >>> MarkdownRemark",timeToRead:3,frontmatter:{date:"2018-05-22T13:35:13.234Z",path:"/2018-05-22-lam-viec-voi-form-trong-react",tags:["javascript","react"],title:"Làm việc với Form trong React"}}}}}});
//# sourceMappingURL=path---2018-05-25-viet-code-javascript-tot-hon-voi-webpack-a7e11e661d3a64483ef4.js.map